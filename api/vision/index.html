
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PyTorch/JAXベースの深層学習モデル構築を支援するライブラリ">
      
      
        <meta name="author" content="oakwood-fujiken, nomutin">
      
      
        <link rel="canonical" href="https://github.com/keio-crl/ml-networks/api/vision/">
      
      
        <link rel="prev" href="../layers/">
      
      
        <link rel="next" href="../distributions/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>ビジョン - ml-networks</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ml-networks" class="md-header__button md-logo" aria-label="ml-networks" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ml-networks
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ビジョン
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/keio-crl/ml-networks" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    keio-crl/ml-networks
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
  
    
  
  クイックスタート

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/config-management/" class="md-tabs__link">
          
  
  
  ガイド

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  API リファレンス

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../development/" class="md-tabs__link">
        
  
  
    
  
  開発

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ml-networks" class="md-nav__button md-logo" aria-label="ml-networks" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ml-networks
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/keio-crl/ml-networks" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    keio-crl/ml-networks
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    クイックスタート
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ガイド
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    ガイド
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/config-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    設定管理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/mlp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MLP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/encoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Encoder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/decoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decoder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/unet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UNet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/loss-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    損失関数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/data-io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    データの保存と読み込み
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    その他の便利な機能
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    高度な機能
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/jax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAXバックエンド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API リファレンス
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API リファレンス
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    レイヤー
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ビジョン
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ビジョン
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        encoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.fc" class="md-nav__link">
    <span class="md-ellipsis">
      
        fc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.feature_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Decoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Decoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Decoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        decoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.fc" class="md-nav__link">
    <span class="md-ellipsis">
      
        fc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.feature_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.has_fc" class="md-nav__link">
    <span class="md-ellipsis">
      
        has_fc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        input_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convnet" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvNet
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvNet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConvNet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convtranspose" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvTranspose
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvTranspose
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConvTranspose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.conv_out_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_out_shapes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.first_conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        first_conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.have_first_conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        have_first_conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.in_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.init_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        init_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.get_input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_input_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resnetpixunshuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixUnshuffle
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixUnshuffle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResNetPixUnshuffle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv1" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv2" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv3" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv3
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.downsample" class="md-nav__link">
    <span class="md-ellipsis">
      
        downsample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.res_blocks" class="md-nav__link">
    <span class="md-ellipsis">
      
        res_blocks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resnetpixshuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixShuffle
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixShuffle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResNetPixShuffle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv1" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv2" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv3" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv3
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_activation" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_activation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_kernel" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_kernel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.dropout" class="md-nav__link">
    <span class="md-ellipsis">
      
        dropout
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.final_kernel" class="md-nav__link">
    <span class="md-ellipsis">
      
        final_kernel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.in_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.n_res_blocks" class="md-nav__link">
    <span class="md-ellipsis">
      
        n_res_blocks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.n_upsampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        n_upsampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.norm" class="md-nav__link">
    <span class="md-ellipsis">
      
        norm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.norm_cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        norm_cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.out_activation" class="md-nav__link">
    <span class="md-ellipsis">
      
        out_activation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.res_blocks" class="md-nav__link">
    <span class="md-ellipsis">
      
        res_blocks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.upsampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        upsampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.upscale_factor" class="md-nav__link">
    <span class="md-ellipsis">
      
        upscale_factor
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.get_input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_input_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ViT
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT" class="md-nav__link">
    <span class="md-ellipsis">
      
        ViT
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ViT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.cls_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        cls_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.in_patch_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_patch_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.in_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.is_encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_encoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.n_patches" class="md-nav__link">
    <span class="md-ellipsis">
      
        n_patches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.out_patch_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        out_patch_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.patch_embed" class="md-nav__link">
    <span class="md-ellipsis">
      
        patch_embed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.patch_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        patch_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.positional_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        positional_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.should_unpatchify" class="md-nav__link">
    <span class="md-ellipsis">
      
        should_unpatchify
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.transformer_cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        transformer_cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.vit" class="md-nav__link">
    <span class="md-ellipsis">
      
        vit
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.get_input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_input_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.get_n_patches" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_n_patches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.get_patch_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_patch_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.patchify" class="md-nav__link">
    <span class="md-ellipsis">
      
        patchify
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.unpatchify" class="md-nav__link">
    <span class="md-ellipsis">
      
        unpatchify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    分布
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../loss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    損失関数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    設定
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ユーティリティ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../activations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    活性化関数
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UNet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../others/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    その他
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JAX API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    開発
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        encoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.fc" class="md-nav__link">
    <span class="md-ellipsis">
      
        fc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.feature_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Encoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Decoder
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Decoder
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Decoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        decoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.fc" class="md-nav__link">
    <span class="md-ellipsis">
      
        fc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.feature_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.has_fc" class="md-nav__link">
    <span class="md-ellipsis">
      
        has_fc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        input_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.Decoder.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convnet" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvNet
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvNet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConvNet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvNet.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convtranspose" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvTranspose
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose" class="md-nav__link">
    <span class="md-ellipsis">
      
        ConvTranspose
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ConvTranspose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.channels" class="md-nav__link">
    <span class="md-ellipsis">
      
        channels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.conv_out_shapes" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_out_shapes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.first_conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        first_conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.have_first_conv" class="md-nav__link">
    <span class="md-ellipsis">
      
        have_first_conv
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.in_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.init_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        init_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ConvTranspose.get_input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_input_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resnetpixunshuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixUnshuffle
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixUnshuffle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResNetPixUnshuffle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv1" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv2" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv3" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv3
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.downsample" class="md-nav__link">
    <span class="md-ellipsis">
      
        downsample
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.res_blocks" class="md-nav__link">
    <span class="md-ellipsis">
      
        res_blocks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixUnshuffle.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resnetpixshuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixShuffle
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResNetPixShuffle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResNetPixShuffle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv1" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv2" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv2
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv3" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv3
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_activation" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_activation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_kernel" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_kernel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.dropout" class="md-nav__link">
    <span class="md-ellipsis">
      
        dropout
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.final_kernel" class="md-nav__link">
    <span class="md-ellipsis">
      
        final_kernel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.in_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.n_res_blocks" class="md-nav__link">
    <span class="md-ellipsis">
      
        n_res_blocks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.n_upsampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        n_upsampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.norm" class="md-nav__link">
    <span class="md-ellipsis">
      
        norm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.norm_cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        norm_cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.out_activation" class="md-nav__link">
    <span class="md-ellipsis">
      
        out_activation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.res_blocks" class="md-nav__link">
    <span class="md-ellipsis">
      
        res_blocks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.upsampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        upsampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.upscale_factor" class="md-nav__link">
    <span class="md-ellipsis">
      
        upscale_factor
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ResNetPixShuffle.get_input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_input_shape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vit" class="md-nav__link">
    <span class="md-ellipsis">
      
        ViT
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT" class="md-nav__link">
    <span class="md-ellipsis">
      
        ViT
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ViT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.cls_token" class="md-nav__link">
    <span class="md-ellipsis">
      
        cls_token
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.conved_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.conved_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        conved_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.in_patch_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_patch_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.in_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        in_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.is_encoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_encoder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.last_channel" class="md-nav__link">
    <span class="md-ellipsis">
      
        last_channel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.n_patches" class="md-nav__link">
    <span class="md-ellipsis">
      
        n_patches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.obs_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        obs_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.out_patch_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        out_patch_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.patch_embed" class="md-nav__link">
    <span class="md-ellipsis">
      
        patch_embed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.patch_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        patch_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.positional_embedding" class="md-nav__link">
    <span class="md-ellipsis">
      
        positional_embedding
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.should_unpatchify" class="md-nav__link">
    <span class="md-ellipsis">
      
        should_unpatchify
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.transformer_cfg" class="md-nav__link">
    <span class="md-ellipsis">
      
        transformer_cfg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.vit" class="md-nav__link">
    <span class="md-ellipsis">
      
        vit
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.forward" class="md-nav__link">
    <span class="md-ellipsis">
      
        forward
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.get_input_shape" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_input_shape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.get_n_patches" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_n_patches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.get_patch_dim" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_patch_dim
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.patchify" class="md-nav__link">
    <span class="md-ellipsis">
      
        patchify
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ml_networks.torch.vision.ViT.unpatchify" class="md-nav__link">
    <span class="md-ellipsis">
      
        unpatchify
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="_1">ビジョン<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>ビジョン関連のモジュール（Encoder、Decoderなど）を提供します。</p>
<p><code>ml_networks.torch.vision</code>（PyTorch）と<code>ml_networks.jax.vision</code>（JAX）の両方で提供されています。</p>
<h2 id="encoder">Encoder<a class="headerlink" href="#encoder" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="ml_networks.torch.vision.Encoder" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Encoder</span>


<a href="#ml_networks.torch.vision.Encoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Encoder</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">fc_cfg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseModule (ml_networks.torch.base.BaseModule)" href="../others/#ml_networks.torch.base.BaseModule">BaseModule</a></code></p>



        <p>Encoder with various architectures.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feature_dim</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimension of the feature tensor.
If int, Encoder includes full connection layer to downsample the feature tensor.
Otherwise, Encoder does not include full connection layer and directly process with backbone network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the input tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>backbone_cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ViTConfig


  
      dataclass
   (ml_networks.config.ViTConfig)" href="../config/#ml_networks.config.ViTConfig">ViTConfig</a> | <a class="autorefs autorefs-internal" title="ConvNetConfig


  
      dataclass
   (ml_networks.config.ConvNetConfig)" href="../config/#ml_networks.config.ConvNetConfig">ConvNetConfig</a> | <a class="autorefs autorefs-internal" title="ResNetConfig


  
      dataclass
   (ml_networks.config.ResNetConfig)" href="../config/#ml_networks.config.ResNetConfig">ResNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fc_cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MLPConfig


  
      dataclass
   (ml_networks.config.MLPConfig)" href="../config/#ml_networks.config.MLPConfig">MLPConfig</a> | <a class="autorefs autorefs-internal" title="LinearConfig


  
      dataclass
   (ml_networks.config.LinearConfig)" href="../config/#ml_networks.config.LinearConfig">LinearConfig</a> | <a class="autorefs autorefs-internal" title="SpatialSoftmaxConfig


  
      dataclass
   (ml_networks.config.SpatialSoftmaxConfig)" href="../config/#ml_networks.config.SpatialSoftmaxConfig">SpatialSoftmaxConfig</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the full connection layer. If feature_dim is tuple, fc_cfg is ignored.
If feature_dim is int, fc_cfg must be provided. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">feature_dim</span> <span class="o">=</span> <span class="mi">128</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConvNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">conv_cfgs</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="p">]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fc_cfg</span> <span class="o">=</span> <span class="n">LinearConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">bias</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">Encoder</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">fc_cfg</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">obs_shape</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">torch.Size([2, 128])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">Encoder(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">  (encoder): ConvNet(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">    (conv): Sequential(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">      (0): ConvNormActivation(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">        (conv): Conv2d(3, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">        (norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">        (pixel_shuffle): Identity()</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">        )</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">      )</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">      (1): ConvNormActivation(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">        (conv): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">        (norm): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">        (pixel_shuffle): Identity()</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">        )</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">      )</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">      (2): ConvNormActivation(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">        (conv): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">        (norm): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">        (pixel_shuffle): Identity()</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">        )</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="go">      )</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="go">    )</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="go">  )</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="go">  (fc): Sequential(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="go">    (0): Flatten(start_dim=1, end_dim=-1)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="go">    (1): LinearNormActivation(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="go">      (linear): Linear(in_features=4096, out_features=128, bias=True)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="go">      (norm): Identity()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="go">      (activation): Activation(</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="go">        (activation): ReLU()</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="go">      )</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="go">      (dropout): Identity()</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="go">    )</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="go">  )</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="go">)</span>
</code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">feature_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">backbone_cfg</span><span class="p">:</span> <span class="n">ViTConfig</span> <span class="o">|</span> <span class="n">ConvNetConfig</span> <span class="o">|</span> <span class="n">ResNetConfig</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">fc_cfg</span><span class="p">:</span> <span class="n">MLPConfig</span> <span class="o">|</span> <span class="n">LinearConfig</span> <span class="o">|</span> <span class="n">SpatialSoftmaxConfig</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ViTConfig</span><span class="p">):</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ViT</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ConvNetConfig</span><span class="p">):</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ConvNet</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ResNetConfig</span><span class="p">):</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ResNetPixUnshuffle</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not implemented&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">feature_dim</span> <span class="o">=</span> <span class="n">feature_dim</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="c1"># 型情報を補うために明示的にキャスト</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conved_size</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">conved_size</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conved_shape</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;tuple[int, int]&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">conved_shape</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">last_channel</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">assert</span> <span class="n">fc_cfg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;fc_cfg must be provided if feature_dim is provided&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">assert</span> <span class="n">feature_dim</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">conved_shape</span><span class="p">),</span> <span class="p">(</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature_dim</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">conved_shape</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fc_cfg</span><span class="p">,</span> <span class="n">MLPConfig</span><span class="p">):</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;feature_dim must be int when using MLPConfig&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="n">MLPLayer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conved_size</span><span class="p">,</span> <span class="n">feature_dim</span><span class="p">,</span> <span class="n">fc_cfg</span><span class="p">),</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fc_cfg</span><span class="p">,</span> <span class="n">LinearConfig</span><span class="p">):</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;feature_dim must be int when using LinearConfig&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">LinearNormActivation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conved_size</span><span class="p">,</span> <span class="n">feature_dim</span><span class="p">,</span> <span class="n">fc_cfg</span><span class="p">),</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fc_cfg</span><span class="p">,</span> <span class="n">AdaptiveAveragePoolingConfig</span><span class="p">):</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;feature_dim must be int when using AdaptiveAveragePoolingConfig&quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">AdaptiveAvgPool2d</span><span class="p">(</span><span class="n">fc_cfg</span><span class="o">.</span><span class="n">output_size</span><span class="p">),</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="n">LinearNormActivation</span><span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">fc_cfg</span><span class="o">.</span><span class="n">output_size</span><span class="p">)),</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="n">feature_dim</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="n">LinearConfig</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="k">else</span> <span class="n">MLPLayer</span><span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">fc_cfg</span><span class="o">.</span><span class="n">output_size</span><span class="p">)),</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="n">feature_dim</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="n">MLPConfig</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="k">else</span> <span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">(),</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="k">if</span> <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">feature_dim</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">*</span> <span class="p">(</span><span class="n">fc_cfg</span><span class="o">.</span><span class="n">output_size</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                    <span class="n">fc_cfg</span><span class="o">.</span><span class="n">output_size</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">fc_cfg</span><span class="o">.</span><span class="n">output_size</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fc_cfg</span><span class="p">,</span> <span class="n">SpatialSoftmaxConfig</span><span class="p">):</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;feature_dim must be int when using SpatialSoftmaxConfig&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="n">SpatialSoftmax</span><span class="p">(</span><span class="n">fc_cfg</span><span class="p">),</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(),</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">LinearNormActivation</span><span class="p">(</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">feature_dim</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="n">LinearConfig</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="k">else</span> <span class="n">MLPLayer</span><span class="p">(</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">feature_dim</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="n">MLPConfig</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="k">else</span> <span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">(),</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="k">if</span> <span class="n">fc_cfg</span><span class="o">.</span><span class="n">additional_layer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">feature_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">





<h3 id="ml_networks.torch.vision.Encoder-attributes">Attributes<a href="#ml_networks.torch.vision.Encoder-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Encoder.conved_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Encoder.conved_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_shape</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;tuple[int, int]&#39;</span><span class="p">,</span> <span class="n">conved_shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Encoder.conved_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Encoder.conved_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_size</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">conved_size</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Encoder.encoder" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">encoder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Encoder.encoder" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">encoder</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Encoder.fc" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">fc</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Encoder.fc" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fc</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Encoder.feature_dim" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">feature_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Encoder.feature_dim" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">feature_dim</span> <span class="o">=</span> <span class="n">feature_dim</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Encoder.last_channel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">last_channel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Encoder.last_channel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">last_channel</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="n">last_channel</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Encoder.obs_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">obs_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Encoder.obs_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="ml_networks.torch.vision.Encoder-functions">Functions<a href="#ml_networks.torch.vision.Encoder-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.Encoder.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#ml_networks.torch.vision.Encoder.forward" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input tensor of shape (batch_size, *obs_shape)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output tensor of shape (batch_size, *feature_dim)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Forward pass.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    x: torch.Tensor</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        input tensor of shape (batch_size, *obs_shape)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    -------</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        output tensor of shape (batch_size, *feature_dim)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">batch_shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span><span class="p">])</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">conved_shape</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">*</span><span class="n">batch_shape</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="decoder">Decoder<a class="headerlink" href="#decoder" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="ml_networks.torch.vision.Decoder" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Decoder</span>


<a href="#ml_networks.torch.vision.Decoder" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Decoder</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">fc_cfg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseModule (ml_networks.torch.base.BaseModule)" href="../others/#ml_networks.torch.base.BaseModule">BaseModule</a></code></p>



        <p>Decoder with various architectures.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feature_dim</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dimension of the feature tensor, if int, Decoder includes full connection layer to upsample the feature tensor.
Otherwise, Decoder does not include full connection layer and directly process with backbone network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the output tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>backbone_cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConvNetConfig


  
      dataclass
   (ml_networks.config.ConvNetConfig)" href="../config/#ml_networks.config.ConvNetConfig">ConvNetConfig</a> | <a class="autorefs autorefs-internal" title="ViTConfig


  
      dataclass
   (ml_networks.config.ViTConfig)" href="../config/#ml_networks.config.ViTConfig">ViTConfig</a> | <a class="autorefs autorefs-internal" title="ResNetConfig


  
      dataclass
   (ml_networks.config.ResNetConfig)" href="../config/#ml_networks.config.ResNetConfig">ResNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fc_cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="MLPConfig


  
      dataclass
   (ml_networks.config.MLPConfig)" href="../config/#ml_networks.config.MLPConfig">MLPConfig</a> | <a class="autorefs autorefs-internal" title="LinearConfig


  
      dataclass
   (ml_networks.config.LinearConfig)" href="../config/#ml_networks.config.LinearConfig">LinearConfig</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the full connection layer. If feature_dim is tuple, fc_cfg is ignored.
If feature_dim is int, fc_cfg must be provided. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">feature_dim</span> <span class="o">=</span> <span class="mi">128</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConvNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">conv_cfgs</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="p">]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fc_cfg</span> <span class="o">=</span> <span class="n">MLPConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">n_layers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="n">output_activation</span><span class="o">=</span> <span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>    <span class="n">linear_cfg</span><span class="o">=</span> <span class="n">LinearConfig</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span>        <span class="n">activation</span><span class="o">=</span> <span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">... </span>        <span class="n">bias</span><span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">... </span>    <span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Decoder</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">fc_cfg</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">feature_dim</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">torch.Size([2, 3, 64, 64])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">Decoder(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">  (fc): MLPLayer(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">    (dense): Sequential(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">      (0): LinearNormActivation(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">        (linear): Linear(in_features=128, out_features=256, bias=True)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">        (norm): Identity()</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="go">        )</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">      )</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">      (1): LinearNormActivation(</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">        (linear): Linear(in_features=256, out_features=256, bias=True)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">        (norm): Identity()</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">        )</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">      )</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">      (2): LinearNormActivation(</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">        (linear): Linear(in_features=256, out_features=1024, bias=True)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">        (norm): Identity()</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">        )</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">      )</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">    )</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">  )</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="go">  (decoder): ConvTranspose(</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="go">    (first_conv): Conv2d(16, 64, kernel_size=(1, 1), stride=(1, 1))</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="go">    (conv): Sequential(</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="go">      (0): ConvTransposeNormActivation(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="go">        (conv): ConvTranspose2d(64, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="go">        (norm): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="go">        )</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="go">      )</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="go">      (1): ConvTransposeNormActivation(</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="go">        (conv): ConvTranspose2d(32, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="go">        (norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="go">        )</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="go">      )</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="go">      (2): ConvTransposeNormActivation(</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="go">        (conv): ConvTranspose2d(16, 3, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="go">        (norm): BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="go">        (activation): Activation(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="go">          (activation): ReLU()</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="go">        )</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="go">        (dropout): Identity()</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="go">      )</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="go">    )</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="go">  )</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="go">)</span>
</code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">feature_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">backbone_cfg</span><span class="p">:</span> <span class="n">ConvNetConfig</span> <span class="o">|</span> <span class="n">ViTConfig</span> <span class="o">|</span> <span class="n">ResNetConfig</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">fc_cfg</span><span class="p">:</span> <span class="n">MLPConfig</span> <span class="o">|</span> <span class="n">LinearConfig</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">feature_dim</span> <span class="o">=</span> <span class="n">feature_dim</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ViTConfig</span><span class="p">):</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">ViT</span><span class="o">.</span><span class="n">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">)</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ConvNetConfig</span><span class="p">):</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="s2">&quot;tuple[int, int, int]&quot;</span><span class="p">,</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="n">ConvTranspose</span><span class="o">.</span><span class="n">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">),</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ResNetConfig</span><span class="p">):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="s2">&quot;tuple[int, int, int]&quot;</span><span class="p">,</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">ResNetPixShuffle</span><span class="o">.</span><span class="n">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">backbone_cfg</span><span class="p">),</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">)</span><span class="si">}</span><span class="s2"> is not implemented&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">assert</span> <span class="n">fc_cfg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;fc_cfg must be provided if feature_dim is provided&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_fc</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="k">assert</span> <span class="n">feature_dim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">feature_dim</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_fc</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fc_cfg</span><span class="p">,</span> <span class="n">MLPConfig</span><span class="p">):</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;feature_dim must be int when using MLPConfig&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="n">MLPLayer</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">)),</span> <span class="n">fc_cfg</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fc_cfg</span><span class="p">,</span> <span class="n">LinearConfig</span><span class="p">):</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s2">&quot;feature_dim must be int when using LinearConfig&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">LinearNormActivation</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">)),</span> <span class="n">fc_cfg</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ViTConfig</span><span class="p">):</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">=</span> <span class="n">ViT</span><span class="p">(</span><span class="n">in_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="o">=</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">backbone_cfg</span><span class="p">)</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ConvNetConfig</span><span class="p">):</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">ConvTranspose</span><span class="p">(</span><span class="n">in_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="o">=</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">backbone_cfg</span><span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backbone_cfg</span><span class="p">,</span> <span class="n">ResNetConfig</span><span class="p">):</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">ResNetPixShuffle</span><span class="p">(</span><span class="n">in_shape</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="o">=</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">backbone_cfg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">





<h3 id="ml_networks.torch.vision.Decoder-attributes">Attributes<a href="#ml_networks.torch.vision.Decoder-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Decoder.decoder" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">decoder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Decoder.decoder" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">decoder</span> <span class="o">=</span> <span class="n">ViT</span><span class="p">(</span><span class="n">in_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="o">=</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">backbone_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Decoder.fc" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">fc</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Decoder.fc" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fc</span> <span class="o">=</span> <span class="n">MLPLayer</span><span class="p">(</span><span class="n">feature_dim</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">prod</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)),</span> <span class="n">fc_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Decoder.feature_dim" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">feature_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Decoder.feature_dim" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">feature_dim</span> <span class="o">=</span> <span class="n">feature_dim</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Decoder.has_fc" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">has_fc</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Decoder.has_fc" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">has_fc</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Decoder.input_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">input_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Decoder.input_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.Decoder.obs_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">obs_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.Decoder.obs_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="ml_networks.torch.vision.Decoder-functions">Functions<a href="#ml_networks.torch.vision.Decoder-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.Decoder.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#ml_networks.torch.vision.Decoder.forward" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input tensor of shape (batch_size, *feature_dim)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output tensor of shape (batch_size, *obs_shape)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">    Forward pass.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    x: torch.Tensor</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        input tensor of shape (batch_size, *feature_dim)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    -------</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">        output tensor of shape (batch_size, *obs_shape)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_fc</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="n">batch_shape</span><span class="p">,</span> <span class="n">data_shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="n">batch_shape</span><span class="p">,</span> <span class="n">data_shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">data_shape</span><span class="p">])</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">input_shape</span><span class="p">])</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="o">*</span><span class="n">batch_shape</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="convnet">ConvNet<a class="headerlink" href="#convnet" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="ml_networks.torch.vision.ConvNet" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ConvNet</span>


<a href="#ml_networks.torch.vision.ConvNet" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ConvNet</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Convolutional Neural Network for Encoder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of input tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConvNetConfig


  
      dataclass
   (ml_networks.config.ConvNetConfig)" href="../config/#ml_networks.config.ConvNetConfig">ConvNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConvNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">conv_cfgs</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="p">]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ConvNet</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">ConvNet(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">  (conv): Sequential(</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">    (0): ConvNormActivation(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">      (conv): Conv2d(3, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">      (norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">      (pixel_shuffle): Identity()</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">      (activation): Activation(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">        (activation): ReLU()</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">      )</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">      (dropout): Identity()</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">    )</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">    (1): ConvNormActivation(</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">      (conv): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">      (norm): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">      (pixel_shuffle): Identity()</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">      (activation): Activation(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">        (activation): ReLU()</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">      )</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">      (dropout): Identity()</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="go">    )</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="go">    (2): ConvNormActivation(</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="go">      (conv): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="go">      (norm): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="go">      (pixel_shuffle): Identity()</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="go">      (activation): Activation(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="go">        (activation): ReLU()</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="go">      )</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="go">      (dropout): Identity()</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="go">    )</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="go">  )</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="go">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">obs_shape</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="go">torch.Size([2, 64, 8, 8])</span>
</code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>    <span class="n">cfg</span><span class="p">:</span> <span class="n">ConvNetConfig</span><span class="p">,</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="n">cfg</span><span class="o">.</span><span class="n">channels</span><span class="p">]</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_conv</span><span class="p">()</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">





<h3 id="ml_networks.torch.vision.ConvNet-attributes">Attributes<a href="#ml_networks.torch.vision.ConvNet-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvNet.cfg" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cfg</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvNet.cfg" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvNet.channels" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">channels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvNet.channels" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="p">(</span><span class="n">channels</span><span class="p">)]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvNet.conv" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvNet.conv" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv</span> <span class="o">=</span> <span class="n">_build_conv</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvNet.conved_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvNet.conved_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the shape of the output tensor after convolutional layers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the output tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConvNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">conv_cfgs</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="p">]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ConvNet</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span><span class="o">.</span><span class="n">conved_shape</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="go">(8, 8)</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvNet.conved_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvNet.conved_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_size</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the size of the output tensor after convolutional layers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>size of the output tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvNet.last_channel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">last_channel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvNet.last_channel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">last_channel</span> <span class="o">=</span> <span class="n">channels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvNet.obs_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">obs_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvNet.obs_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="ml_networks.torch.vision.ConvNet-functions">Functions<a href="#ml_networks.torch.vision.ConvNet-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ConvNet.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#ml_networks.torch.vision.ConvNet.forward" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input tensor of shape (batch_size, *obs_shape)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output tensor of shape (batch_size, self.last_channel, *self.conved_shape)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">    Forward pass.</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">    x: torch.Tensor</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">        input tensor of shape (batch_size, *obs_shape)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">    -------</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">        output tensor of shape (batch_size, self.last_channel, *self.conved_shape)</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="convtranspose">ConvTranspose<a class="headerlink" href="#convtranspose" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="ml_networks.torch.vision.ConvTranspose" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ConvTranspose</span>


<a href="#ml_networks.torch.vision.ConvTranspose" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ConvTranspose</span><span class="p">(</span><span class="n">in_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Convolutional Transpose Network for Decoder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>in_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of input tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of output tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConvNetConfig


  
      dataclass
   (ml_networks.config.ConvNetConfig)" href="../config/#ml_networks.config.ConvNetConfig">ConvNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">in_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConvNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">conv_cfgs</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="p">]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder</span> <span class="o">=</span> <span class="n">ConvTranspose</span><span class="p">(</span><span class="n">in_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="go">ConvTranspose(</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="go">  (first_conv): Conv2d(128, 64, kernel_size=(1, 1), stride=(1, 1))</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="go">  (conv): Sequential(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="go">    (0): ConvTransposeNormActivation(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="go">      (conv): ConvTranspose2d(64, 32, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="go">      (norm): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">      (activation): Activation(</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">        (activation): ReLU()</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">      )</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="go">      (dropout): Identity()</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="go">    )</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="go">    (1): ConvTransposeNormActivation(</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="go">      (conv): ConvTranspose2d(32, 16, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="go">      (norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="go">      (activation): Activation(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="go">        (activation): ReLU()</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="go">      )</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="go">      (dropout): Identity()</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="go">    )</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="go">    (2): ConvTransposeNormActivation(</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="go">      (conv): ConvTranspose2d(16, 3, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="go">      (norm): BatchNorm2d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="go">      (activation): Activation(</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="go">        (activation): ReLU()</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="go">      )</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="go">      (dropout): Identity()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="go">    )</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="go">  )</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="go">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">in_shape</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="go">torch.Size([2, 3, 64, 64])</span>
</code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a>    <span class="n">in_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a>    <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a>    <span class="n">cfg</span><span class="p">:</span> <span class="n">ConvNetConfig</span><span class="p">,</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_shape</span> <span class="o">=</span> <span class="n">in_shape</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv_out_shapes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">cfg</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">conv_cfgs</span><span class="p">)</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first_conv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cfg</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">init_channel</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">have_first_conv</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">init_channel</span> <span class="o">=</span> <span class="n">in_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">have_first_conv</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>    <span class="n">prev_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>    <span class="k">for</span> <span class="n">conv_cfg</span> <span class="ow">in</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_cfgs</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a>        <span class="n">padding</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">,</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">stride</span><span class="p">,</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">dilation</span><span class="p">,</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>        <span class="p">)</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a>        <span class="n">prev_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">conv_transpose_out_shape</span><span class="p">(</span><span class="n">prev_shape</span><span class="p">,</span> <span class="n">padding</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="p">))</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">conv_out_shapes</span> <span class="o">+=</span> <span class="p">[</span><span class="n">prev_shape</span><span class="p">]</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_out_shapes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_out_shapes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_conv</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">





<h3 id="ml_networks.torch.vision.ConvTranspose-attributes">Attributes<a href="#ml_networks.torch.vision.ConvTranspose-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.cfg" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cfg</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.cfg" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.channels" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">channels</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.channels" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">channels</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="n">channels</span><span class="p">),</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.conv" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.conv" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv</span> <span class="o">=</span> <span class="n">_build_conv</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.conv_out_shapes" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv_out_shapes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.conv_out_shapes" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv_out_shapes</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.first_conv" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">first_conv</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.first_conv" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">first_conv</span> <span class="o">=</span> <span class="n">Conv2d</span><span class="p">(</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.have_first_conv" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">have_first_conv</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.have_first_conv" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">have_first_conv</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.in_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">in_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.in_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">in_shape</span> <span class="o">=</span> <span class="n">in_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.init_channel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">init_channel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.init_channel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">init_channel</span> <span class="o">=</span> <span class="n">channels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ConvTranspose.obs_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">obs_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.obs_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="ml_networks.torch.vision.ConvTranspose-functions">Functions<a href="#ml_networks.torch.vision.ConvTranspose-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ConvTranspose.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#ml_networks.torch.vision.ConvTranspose.forward" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>z</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input tensor of shape (batch_size, *in_shape)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output tensor of shape (batch_size, *obs_shape)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">    Forward pass.</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">    z: torch.Tensor</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">        input tensor of shape (batch_size, *in_shape)</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">        output tensor of shape (batch_size, *obs_shape)</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">have_first_conv</span><span class="p">:</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>        <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first_conv</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ConvTranspose.get_input_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_input_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ml_networks.torch.vision.ConvTranspose.get_input_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get input shape of the decoder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the output tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConvNetConfig


  
      dataclass
   (ml_networks.config.ConvNetConfig)" href="../config/#ml_networks.config.ConvNetConfig">ConvNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the input tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ConvNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">conv_cfgs</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="n">ConvConfig</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="p">]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">ConvTranspose</span><span class="o">.</span><span class="n">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="go">(16, 8, 8)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">ConvNetConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">    Get input shape of the decoder.</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a><span class="sd">    obs_shape: tuple[int, int, int]</span>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">        shape of the output tensor</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">    cfg: ConvNetConfig</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">        configuration of the network</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">    tuple[int, int, int]</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">        shape of the input tensor</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">    &gt;&gt;&gt; obs_shape = (3, 64, 64)</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">    &gt;&gt;&gt; cfg = ConvNetConfig(</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">    ...     channels=[64, 32, 16],</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">    ...     conv_cfgs=[</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">    ...         ConvConfig(kernel_size=4, stride=2, padding=1, activation=&quot;ReLU&quot;, norm=&quot;batch&quot;, dropout=0.0),</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">    ...         ConvConfig(kernel_size=4, stride=2, padding=1, activation=&quot;ReLU&quot;, norm=&quot;batch&quot;, dropout=0.0),</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">    ...         ConvConfig(kernel_size=4, stride=2, padding=1, activation=&quot;ReLU&quot;, norm=&quot;batch&quot;, dropout=0.0),</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a><span class="sd">    ...     ]</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">    &gt;&gt;&gt; ConvTranspose.get_input_shape(obs_shape, cfg)</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">    (16, 8, 8)</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>    <span class="n">in_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>    <span class="k">for</span> <span class="n">conv_cfg</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">conv_cfgs</span><span class="p">):</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>        <span class="n">padding</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">kernel_size</span><span class="p">,</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">stride</span><span class="p">,</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>            <span class="n">conv_cfg</span><span class="o">.</span><span class="n">dilation</span><span class="p">,</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>        <span class="p">)</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>        <span class="n">in_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">conv_transpose_in_shape</span><span class="p">(</span><span class="n">in_shape</span><span class="p">,</span> <span class="n">padding</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">dilation</span><span class="p">))</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">init_channel</span><span class="p">,</span> <span class="o">*</span><span class="n">in_shape</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="resnetpixunshuffle">ResNetPixUnshuffle<a class="headerlink" href="#resnetpixunshuffle" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="ml_networks.torch.vision.ResNetPixUnshuffle" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ResNetPixUnshuffle</span>


<a href="#ml_networks.torch.vision.ResNetPixUnshuffle" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ResNetPixUnshuffle</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>ResNet with PixelUnshuffle for Encoder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of input tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ResNetConfig


  
      dataclass
   (ml_networks.config.ResNetConfig)" href="../config/#ml_networks.config.ResNetConfig">ResNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ResNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">conv_channel</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">conv_kernel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">f_kernel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">conv_activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">out_activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">n_res_blocks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">n_scaling</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">norm_cfg</span><span class="o">=</span><span class="p">{},</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ResNetPixUnshuffle</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">obs_shape</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="go">torch.Size([2, 64, 8, 8])</span>
</code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>    <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="n">cfg</span><span class="p">:</span> <span class="n">ResNetConfig</span><span class="p">,</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>    <span class="n">first_cfg</span> <span class="o">=</span> <span class="n">ConvConfig</span><span class="p">(</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="n">activation</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">conv_activation</span><span class="p">,</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">kernel_size</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">f_kernel</span><span class="p">,</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">padding</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">f_kernel</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="n">groups</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">dropout</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">norm</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="n">norm_cfg</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">norm_cfg</span><span class="p">,</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="n">padding_mode</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">padding_mode</span><span class="p">,</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="c1"># First layer</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">first_cfg</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="c1"># downsampling</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="n">downsample</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="n">downsample_cfg</span> <span class="o">=</span> <span class="n">first_cfg</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="n">downsample_cfg</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="n">downsample_cfg</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="n">downsample_cfg</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="o">-</span><span class="n">cfg</span><span class="o">.</span><span class="n">scale_factor</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_scaling</span><span class="p">):</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="n">downsample</span> <span class="o">+=</span> <span class="p">[</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">downsample_cfg</span><span class="p">),</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="p">]</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">downsample</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">downsample</span><span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>    <span class="c1"># Residual blocks</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>    <span class="n">res_blocks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_res_blocks</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">res_blocks</span> <span class="o">+=</span> <span class="p">[</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>            <span class="n">ResidualBlock</span><span class="p">(</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">conv_activation</span><span class="p">,</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">norm_cfg</span><span class="p">,</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">padding_mode</span><span class="p">,</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>            <span class="p">),</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="p">]</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">attention</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="n">res_blocks</span> <span class="o">+=</span> <span class="p">[</span><span class="n">Attention2d</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">nhead</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attn_cfg</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">attention</span><span class="p">)]</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">res_blocks</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">res_blocks</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">cov2_cfg</span> <span class="o">=</span> <span class="n">first_cfg</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="n">cov2_cfg</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="n">cov2_cfg</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="n">cov2_cfg</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="c1"># Second conv layer post residual blocks</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">cov2_cfg</span><span class="p">)</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>    <span class="c1"># Final output layer</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>    <span class="n">final_cfg</span> <span class="o">=</span> <span class="n">first_cfg</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv3</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">final_cfg</span><span class="p">)</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">





<h3 id="ml_networks.torch.vision.ResNetPixUnshuffle-attributes">Attributes<a href="#ml_networks.torch.vision.ResNetPixUnshuffle-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.cfg" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cfg</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.cfg" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.conv1" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv1</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv1" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv1</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">conv_channel</span><span class="p">,</span> <span class="n">first_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.conv2" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv2</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv2" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv2</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">conv_channel</span><span class="p">,</span> <span class="n">cov2_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.conv3" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv3</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conv3" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv3</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">conv_channel</span><span class="p">,</span> <span class="n">final_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.conved_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conved_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the shape of the output tensor after convolutional layers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the output tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.conved_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.conved_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_size</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the size of the output tensor after convolutional layers.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>size of the output tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.downsample" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">downsample</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.downsample" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">downsample</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">downsample</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.last_channel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">last_channel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.last_channel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">last_channel</span> <span class="o">=</span> <span class="n">conv_channel</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.obs_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">obs_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.obs_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.res_blocks" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">res_blocks</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.res_blocks" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">res_blocks</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">res_blocks</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="ml_networks.torch.vision.ResNetPixUnshuffle-functions">Functions<a href="#ml_networks.torch.vision.ResNetPixUnshuffle-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ResNetPixUnshuffle.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#ml_networks.torch.vision.ResNetPixUnshuffle.forward" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input tensor of shape (batch_size, *obs_shape)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output tensor of shape (batch_size, self.last_channel, *self.conved_shape)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="sd">    Forward pass.</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">    x: torch.Tensor</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">        input tensor of shape (batch_size, *obs_shape)</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">    -------</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">        output tensor of shape (batch_size, self.last_channel, *self.conved_shape)</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>    <span class="n">out1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">downsample</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>    <span class="n">out_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_blocks</span><span class="p">(</span><span class="n">out1</span><span class="p">)</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>    <span class="n">out2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">out_res</span><span class="p">)</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">out1</span><span class="p">,</span> <span class="n">out2</span><span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv3</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="resnetpixshuffle">ResNetPixShuffle<a class="headerlink" href="#resnetpixshuffle" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="ml_networks.torch.vision.ResNetPixShuffle" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ResNetPixShuffle</span>


<a href="#ml_networks.torch.vision.ResNetPixShuffle" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ResNetPixShuffle</span><span class="p">(</span><span class="n">in_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>ResNet with PixelShuffle.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>in_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of input tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of output tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ResNetConfig


  
      dataclass
   (ml_networks.config.ResNetConfig)" href="../config/#ml_networks.config.ResNetConfig">ResNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">in_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">obs_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ResNetConfig</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">conv_channel</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">conv_kernel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">f_kernel</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>    <span class="n">conv_activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>    <span class="n">out_activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>    <span class="n">n_res_blocks</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">scale_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">n_scaling</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">norm</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>    <span class="n">norm_cfg</span><span class="o">=</span><span class="p">{},</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder</span> <span class="o">=</span> <span class="n">ResNetPixShuffle</span><span class="p">(</span><span class="n">in_shape</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">in_shape</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="go">torch.Size([2, 3, 64, 64])</span>
</code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-971" name="__codelineno-0-971"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="n">in_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>    <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>    <span class="n">cfg</span><span class="p">:</span> <span class="n">ResNetConfig</span><span class="p">,</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_shape</span> <span class="o">=</span> <span class="n">in_shape</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_channel</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv_kernel</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_kernel</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">final_kernel</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">f_kernel</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv_activation</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">conv_activation</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_activation</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">out_activation</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_res_blocks</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">n_res_blocks</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">upscale_factor</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scale_factor</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_upsampling</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">n_scaling</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">norm</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">norm_cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">norm_cfg</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">dropout</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_scaling_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upscale_factor</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">n_upsampling</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>    <span class="n">height</span> <span class="o">=</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="n">width</span> <span class="o">=</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>    <span class="n">out_channels</span> <span class="o">=</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scaling_factor</span><span class="p">,</span> <span class="n">width</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scaling_factor</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_height</span> <span class="o">==</span> <span class="n">in_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_height</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_width</span> <span class="o">==</span> <span class="n">in_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_width</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>    <span class="n">conv_cfg</span> <span class="o">=</span> <span class="n">ConvConfig</span><span class="p">(</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="n">activation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_activation</span><span class="p">,</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>        <span class="n">kernel_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_kernel</span><span class="p">,</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>        <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>        <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_kernel</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="n">dilation</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="n">groups</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>        <span class="n">norm</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="n">norm_cfg</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">norm_cfg</span><span class="p">,</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>        <span class="n">padding_mode</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">padding_mode</span><span class="p">,</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>    <span class="p">)</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>    <span class="c1"># First layer</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">conv_cfg</span><span class="p">)</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a>    <span class="c1"># Residual blocks</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>    <span class="n">res_blocks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_res_blocks</span><span class="p">):</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a>        <span class="n">res_blocks</span> <span class="o">+=</span> <span class="p">[</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>            <span class="n">ResidualBlock</span><span class="p">(</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">conv_kernel</span><span class="p">,</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">conv_activation</span><span class="p">,</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">norm_cfg</span><span class="p">,</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>                <span class="n">cfg</span><span class="o">.</span><span class="n">padding_mode</span><span class="p">,</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a>            <span class="p">),</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>        <span class="p">]</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a>        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">attention</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>            <span class="n">res_blocks</span> <span class="o">+=</span> <span class="p">[</span><span class="n">Attention2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">nhead</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attn_cfg</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">attention</span><span class="p">)]</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">res_blocks</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">res_blocks</span><span class="p">)</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>    <span class="c1"># Second conv layer post residual blocks</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">conv_cfg</span><span class="p">)</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>    <span class="n">upscale_cfg</span> <span class="o">=</span> <span class="n">conv_cfg</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>    <span class="n">upscale_cfg</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upscale_factor</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>    <span class="c1"># Upsampling layers</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a>    <span class="n">upsampling</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_upsampling</span><span class="p">):</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a>        <span class="n">upsampling</span> <span class="o">+=</span> <span class="p">[</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a>            <span class="n">ConvNormActivation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">upscale_cfg</span><span class="p">),</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a>        <span class="p">]</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">upsampling</span><span class="p">)</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>    <span class="n">final_cfg</span> <span class="o">=</span> <span class="n">conv_cfg</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_kernel</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">final_kernel</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">activation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_activation</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">norm_cfg</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>    <span class="n">final_cfg</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>    <span class="c1"># Final output layer</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">conv3</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">final_cfg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">





<h3 id="ml_networks.torch.vision.ResNetPixShuffle-attributes">Attributes<a href="#ml_networks.torch.vision.ResNetPixShuffle-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.conv1" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv1</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.conv1" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv1</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">in_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">conv_channel</span><span class="p">,</span> <span class="n">conv_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.conv2" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv2</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.conv2" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv2</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">conv_channel</span><span class="p">,</span> <span class="n">conv_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.conv3" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv3</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.conv3" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv3</span> <span class="o">=</span> <span class="n">ConvNormActivation</span><span class="p">(</span><span class="n">conv_channel</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">final_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.conv_activation" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv_activation</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_activation" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv_activation</span> <span class="o">=</span> <span class="n">conv_activation</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.conv_channel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv_channel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_channel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv_channel</span> <span class="o">=</span> <span class="n">conv_channel</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.conv_kernel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conv_kernel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.conv_kernel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv_kernel</span> <span class="o">=</span> <span class="n">conv_kernel</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.dropout" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">dropout</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.dropout" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.final_kernel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">final_kernel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.final_kernel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">final_kernel</span> <span class="o">=</span> <span class="n">f_kernel</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.in_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">in_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.in_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">in_shape</span> <span class="o">=</span> <span class="n">in_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.n_res_blocks" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">n_res_blocks</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.n_res_blocks" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">n_res_blocks</span> <span class="o">=</span> <span class="n">n_res_blocks</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.n_upsampling" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">n_upsampling</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.n_upsampling" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">n_upsampling</span> <span class="o">=</span> <span class="n">n_scaling</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.norm" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">norm</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.norm" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">norm</span> <span class="o">=</span> <span class="n">norm</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.norm_cfg" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">norm_cfg</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.norm_cfg" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">norm_cfg</span> <span class="o">=</span> <span class="n">norm_cfg</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.obs_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">obs_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.obs_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.out_activation" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">out_activation</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.out_activation" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">out_activation</span> <span class="o">=</span> <span class="n">out_activation</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.res_blocks" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">res_blocks</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.res_blocks" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">res_blocks</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">res_blocks</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.upsampling" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">upsampling</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.upsampling" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">upsampling</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">upsampling</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ResNetPixShuffle.upscale_factor" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">upscale_factor</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.upscale_factor" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">upscale_factor</span> <span class="o">=</span> <span class="n">scale_factor</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="ml_networks.torch.vision.ResNetPixShuffle-functions">Functions<a href="#ml_networks.torch.vision.ResNetPixShuffle-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ResNetPixShuffle.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#ml_networks.torch.vision.ResNetPixShuffle.forward" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input tensor of shape (batch_size, *in_shape)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output tensor of shape (batch_size, *obs_shape)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">    Forward pass.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">    x: torch.Tensor</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        input tensor of shape (batch_size, *in_shape)</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">        output tensor of shape (batch_size, *obs_shape)</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>    <span class="n">out1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_blocks</span><span class="p">(</span><span class="n">out1</span><span class="p">)</span>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a>    <span class="n">out2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">out1</span><span class="p">,</span> <span class="n">out2</span><span class="p">)</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a>    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upsampling</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv3</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ResNetPixShuffle.get_input_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_input_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ml_networks.torch.vision.ResNetPixShuffle.get_input_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get input shape of the decoder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the output tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ResNetConfig


  
      dataclass
   (ml_networks.config.ResNetConfig)" href="../config/#ml_networks.config.ResNetConfig">ResNetConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the input tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">ResNetConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">    Get input shape of the decoder.</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">    obs_shape: tuple[int, int, int]</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a><span class="sd">        shape of the output tensor</span>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">    cfg: ConvNetConfig</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a><span class="sd">        configuration of the network</span>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">    tuple[int, int, int]</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">        shape of the input tensor</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a>        <span class="n">cfg</span><span class="o">.</span><span class="n">init_channel</span><span class="p">,</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a>        <span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">scale_factor</span><span class="o">**</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_scaling</span><span class="p">),</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a>        <span class="n">obs_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">//</span> <span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">scale_factor</span><span class="o">**</span><span class="n">cfg</span><span class="o">.</span><span class="n">n_scaling</span><span class="p">),</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="vit">ViT<a class="headerlink" href="#vit" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h2 id="ml_networks.torch.vision.ViT" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ViT</span>


<a href="#ml_networks.torch.vision.ViT" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ViT</span><span class="p">(</span><span class="n">in_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">obs_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>



        <p>Vision Transformer for Encoder and Decoder.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>in_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of input tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfg</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ViTConfig


  
      dataclass
   (ml_networks.config.ViTConfig)" href="../config/#ml_networks.config.ViTConfig">ViTConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>configuration of the network</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_shape</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>, <span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of output tensor. If None, it is considered as Encoder. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">ml_networks.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformerConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">in_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">ViTConfig</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">patch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">cls_token</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">transformer_cfg</span><span class="o">=</span><span class="n">TransformerConfig</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span>        <span class="n">d_model</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">... </span>        <span class="n">nhead</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">... </span>        <span class="n">dim_ff</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>        <span class="n">dropout</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>        <span class="n">hidden_activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span>        <span class="n">output_activation</span><span class="o">=</span><span class="s2">&quot;ReLU&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="gp">... </span>    <span class="p">),</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="gp">... </span>    <span class="n">init_channel</span><span class="o">=</span><span class="mi">3</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">ViT</span><span class="p">(</span><span class="n">in_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">in_shape</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="go">torch.Size([2, 1, 64, 64])</span>
</code></pre></div>








                  <details class="mkdocstrings-source">
                    <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">in_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="n">cfg</span><span class="p">:</span> <span class="n">ViTConfig</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_shape</span> <span class="o">=</span> <span class="n">in_shape</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span> <span class="k">if</span> <span class="n">obs_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">in_shape</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">patch_size</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">patch_size</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">transformer_cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">transformer_cfg</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">in_patch_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_dim</span><span class="p">(</span><span class="n">in_shape</span><span class="p">)</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">out_patch_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_dim</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">obs_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_cfg</span><span class="o">.</span><span class="n">d_model</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">positional_embedding</span> <span class="o">=</span> <span class="n">PositionalEncoding</span><span class="p">(</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_patch_dim</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_cfg</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">max_len</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_n_patches</span><span class="p">(</span><span class="n">in_shape</span><span class="p">),</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">vit</span> <span class="o">=</span> <span class="n">TransformerLayer</span><span class="p">(</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">in_patch_dim</span><span class="p">,</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">out_patch_dim</span><span class="p">,</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_cfg</span><span class="p">,</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_encoder</span> <span class="o">=</span> <span class="n">obs_shape</span> <span class="ow">is</span> <span class="kc">None</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_encoder</span><span class="p">:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_patches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_n_patches</span><span class="p">(</span><span class="n">in_shape</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">patch_embed</span> <span class="o">=</span> <span class="n">PatchEmbed</span><span class="p">(</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="n">emb_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_patch_dim</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="n">patch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">patch_size</span><span class="p">,</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="n">obs_shape</span><span class="o">=</span><span class="n">in_shape</span><span class="p">,</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="p">)</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">should_unpatchify</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">unpatchify</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">cls_token</span><span class="p">:</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cls_token</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_patch_dim</span><span class="p">))</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">last_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_n_patches</span><span class="p">(</span><span class="n">in_shape</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



<div class="doc doc-children">





<h3 id="ml_networks.torch.vision.ViT-attributes">Attributes<a href="#ml_networks.torch.vision.ViT-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.cfg" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cfg</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.cfg" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.cls_token" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cls_token</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.cls_token" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cls_token</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">in_patch_dim</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.conved_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.conved_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.conved_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">conved_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.conved_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conved_size</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.in_patch_dim" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">in_patch_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.in_patch_dim" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">in_patch_dim</span> <span class="o">=</span> <span class="n">get_patch_dim</span><span class="p">(</span><span class="n">in_shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.in_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">in_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.in_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">in_shape</span> <span class="o">=</span> <span class="n">in_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.is_encoder" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">is_encoder</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.is_encoder" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">is_encoder</span> <span class="o">=</span> <span class="n">obs_shape</span> <span class="ow">is</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.last_channel" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">last_channel</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.last_channel" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">last_channel</span> <span class="o">=</span> <span class="n">get_n_patches</span><span class="p">(</span><span class="n">in_shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.n_patches" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">n_patches</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.n_patches" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">n_patches</span> <span class="o">=</span> <span class="n">get_n_patches</span><span class="p">(</span><span class="n">in_shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.obs_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">obs_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.obs_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">obs_shape</span> <span class="o">=</span> <span class="n">obs_shape</span> <span class="k">if</span> <span class="n">obs_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">in_shape</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.out_patch_dim" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">out_patch_dim</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.out_patch_dim" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">out_patch_dim</span> <span class="o">=</span> <span class="n">get_patch_dim</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">)</span> <span class="k">if</span> <span class="n">obs_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">d_model</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.patch_embed" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">patch_embed</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.patch_embed" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">patch_embed</span> <span class="o">=</span> <span class="n">PatchEmbed</span><span class="p">(</span><span class="n">emb_dim</span><span class="o">=</span><span class="n">in_patch_dim</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="n">patch_size</span><span class="p">,</span> <span class="n">obs_shape</span><span class="o">=</span><span class="n">in_shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.patch_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">patch_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.patch_size" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">patch_size</span> <span class="o">=</span> <span class="n">patch_size</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.positional_embedding" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">positional_embedding</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.positional_embedding" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">positional_embedding</span> <span class="o">=</span> <span class="n">PositionalEncoding</span><span class="p">(</span><span class="n">in_patch_dim</span><span class="p">,</span> <span class="n">dropout</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="n">get_n_patches</span><span class="p">(</span><span class="n">in_shape</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.should_unpatchify" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">should_unpatchify</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.should_unpatchify" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">should_unpatchify</span> <span class="o">=</span> <span class="n">unpatchify</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.transformer_cfg" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">transformer_cfg</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.transformer_cfg" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">transformer_cfg</span> <span class="o">=</span> <span class="n">transformer_cfg</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="ml_networks.torch.vision.ViT.vit" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">vit</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.vit" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">vit</span> <span class="o">=</span> <span class="n">TransformerLayer</span><span class="p">(</span><span class="n">in_patch_dim</span><span class="p">,</span> <span class="n">out_patch_dim</span><span class="p">,</span> <span class="n">transformer_cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<h3 id="ml_networks.torch.vision.ViT-functions">Functions<a href="#ml_networks.torch.vision.ViT-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ViT.forward" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">forward</span>


<a href="#ml_networks.torch.vision.ViT.forward" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">forward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">return_cls_token</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forward pass.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>input tensor of shape (batch_size, *in_shape)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_cls_token</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to return cls_token. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output tensor of shape (batch_size, *obs_shape)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cls_token of shape (batch_size, self.out_patch_dim) if return_cls_token</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="n">return_cls_token</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    Forward pass.</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    x: torch.Tensor</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        input tensor of shape (batch_size, *in_shape)</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">    return_cls_token: bool</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        whether to return cls_token. Default is False.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">    -------</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">        output tensor of shape (batch_size, *obs_shape)</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        cls_token of shape (batch_size, self.out_patch_dim) if return_cls_token</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch_embed</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_encoder</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">patchify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cls_token&quot;</span><span class="p">):</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="n">cls_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls_token</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">cls_token</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cls_token&quot;</span><span class="p">):</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">cls_token</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_unpatchify</span><span class="p">:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unpatchify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="k">if</span> <span class="n">return_cls_token</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;cls_token&quot;</span><span class="p">):</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="k">return</span> <span class="n">cls_token</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ViT.get_input_shape" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_input_shape</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ml_networks.torch.vision.ViT.get_input_shape" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_input_shape</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">ViTConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">init_channel</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ViT.get_n_patches" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_n_patches</span>


<a href="#ml_networks.torch.vision.ViT.get_n_patches" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_n_patches</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_n_patches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch_size</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ViT.get_patch_dim" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_patch_dim</span>


<a href="#ml_networks.torch.vision.ViT.get_patch_dim" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_patch_dim</span><span class="p">(</span><span class="n">obs_shape</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_patch_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_shape</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch_size</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">obs_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ViT.patchify" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">patchify</span>


<a href="#ml_networks.torch.vision.ViT.patchify" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">patchify</span><span class="p">(</span><span class="n">imgs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>画像をパッチに分割する.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>imgs</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>入力画像. (N, C, H, W)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>パッチ化した画像. (N, L, patch_size**2 * D)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="k">def</span><span class="w"> </span><span class="nf">patchify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imgs</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    画像をパッチに分割する.</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    imgs: torch.Tensor</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        入力画像. (N, C, H, W)</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">    -------</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    torch.Tensor</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">        パッチ化した画像. (N, L, patch_size**2 * D)</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch_size</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>    <span class="k">assert</span> <span class="n">imgs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="k">assert</span> <span class="n">imgs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">%</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">return</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">imgs</span><span class="p">,</span> <span class="s2">&quot;n c (h p1) (w p2) -&gt; n (h w) (p1 p2 c)&quot;</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="ml_networks.torch.vision.ViT.unpatchify" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">unpatchify</span>


<a href="#ml_networks.torch.vision.ViT.unpatchify" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">unpatchify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>パッチを画像に戻す.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="torch.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>入力. (N, L, patch_size**2 * D)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    画像. (N, C, H, W)</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/ml_networks/torch/vision.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="k">def</span><span class="w"> </span><span class="nf">unpatchify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    パッチを画像に戻す.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">    x : torch.Tensor</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">        入力. (N, L, patch_size**2 * D)</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">    -------</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">        画像. (N, C, H, W)</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch_size</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">p</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">//</span> <span class="n">p</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">assert</span> <span class="n">h</span> <span class="o">*</span> <span class="n">w</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">w</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, please check the shape </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> and obs_shape </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_shape</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>    <span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="k">return</span> <span class="n">rearrange</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;n (h w) (p1 p2 c) -&gt; n c (h p1) (w p2)&quot;</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 14, 2026 00:23:13 UTC">February 14, 2026</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 14, 2026 00:23:13 UTC">February 14, 2026</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.annotate", "content.code.copy", "content.code.select", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>